# 股票监控系统

定时查询指定沪深A股的股票价格以及当天涨跌幅度，支持配置天数和涨幅阈值，当涨跌的天数或幅度达到配置的阈值时，生成报告文档。

## 功能特性

- 实时获取股票价格和涨跌幅
- 支持连续涨跌天数监控
- 支持单日涨跌幅监控
- 可配置的阈值设置
- 定时任务支持
- 自动生成监控报告

## 项目结构

```
StockTrae/
├── main.py              # 主程序入口
├── config.py            # 配置管理模块
├── stock_fetcher.py     # 股票数据获取模块
├── threshold_checker.py # 阈值判断模块
├── report_generator.py  # 报告生成模块
├── scheduler.py         # 定时任务模块
├── config.yaml          # 配置文件
├── requirements.txt     # 依赖包列表
└── output/              # 报告输出目录（自动创建）
```

## 安装依赖

```bash
pip install -r requirements.txt
```

## 配置说明

编辑 `config.yaml` 文件来配置监控参数：

### 股票列表配置

```yaml
stocks:
  - code: "000001"
    name: "平安银行"
  - code: "600000"
    name: "浦发银行"
```

### 阈值配置

```yaml
thresholds:
  # 连续涨跌天数监控
  consecutive_days:
    enabled: true
    rise_days: 3      # 连续上涨3天触发
    fall_days: 3      # 连续下跌3天触发
  
  # 单日涨跌幅监控
  daily_change:
    enabled: true
    rise_percent: 5.0    # 单日涨幅达到5%触发
    fall_percent: -5.0    # 单日跌幅达到5%触发
```

### 定时任务配置

```yaml
schedule:
  enabled: true
  time: "15:00"  # 每天15:00执行
```

### 输出配置

```yaml
output:
  directory: "output"
  filename: "stock_alert_{date}.txt"
```

## 使用方法

### 执行一次监控任务

```bash
python main.py --once
```

### 启动定时任务

```bash
python main.py --schedule
```

### 使用自定义配置文件

```bash
python main.py --config custom_config.yaml --once
```

## 报告格式

当股票触发阈值时，会生成包含以下信息的报告：

- 股票代码
- 股票名称
- 当前价格
- 当日涨跌幅
- 触发的阈值描述

示例报告：

```
================================================================================
股票监控报告
生成时间: 2026-01-15 15:00:00
================================================================================

【1】股票代码: 000001
股票名称: 平安银行
当前价格: 12.50 元
当日涨跌: 5.20%

触发阈值:
  - 单日涨幅达到5.0%
  - 连续3天上涨（阈值：3天）

--------------------------------------------------------------------------------

总计: 1 只股票触发阈值
================================================================================
```

## 注意事项

1. 确保网络连接正常，以便获取股票数据
2. 定时任务建议在交易时间（工作日9:30-15:00）之外运行
3. 历史数据获取可能需要一定时间，请耐心等待
4. 建议根据实际需求调整阈值配置

## 技术栈

- Python 3.7+
- akshare: 股票数据获取
- pyyaml: 配置文件解析
- schedule: 定时任务
- pandas: 数据处理
